<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="pt-br" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Terraform Além do Básico: Utilizando count, for_each e Expressões Condicionais" />
<meta property="og:locale" content="pt_br" />
<meta name="description" content="Introdução" />
<meta property="og:description" content="Introdução" />
<link rel="canonical" href="https://leonam.cloud/posts/terraform-alem-do-basico-count-foreach-condicionais/" />
<meta property="og:url" content="https://leonam.cloud/posts/terraform-alem-do-basico-count-foreach-condicionais/" />
<meta property="og:site_name" content="Leonam Vasquez" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-10-23T05:00:00-03:00" />
<meta property="og:image" content="https://leonam.cloud/assets/img/preview.png" /><meta name="twitter:card" content="summary_large_image" />
      <meta property="twitter:image" content="https://leonam.cloud/assets/img/preview.png" />
<meta property="twitter:title" content="Terraform Além do Básico: Utilizando count, for_each e Expressões Condicionais" />
<meta name="google-site-verification" content="" />
<meta name="msvalidate.01" content="" />
<meta name="alexaVerifyID" content="" />
<meta name="yandex-verification" content="" />
<meta name="baidu-site-verification" content="" />
<meta name="facebook-domain-verification" content="" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-11-13T15:15:28-03:00","datePublished":"2025-10-23T05:00:00-03:00","description":"Introdução","headline":"Terraform Além do Básico: Utilizando count, for_each e Expressões Condicionais","mainEntityOfPage":{"@type":"WebPage","@id":"https://leonam.cloud/posts/terraform-alem-do-basico-count-foreach-condicionais/"},"url":"https://leonam.cloud/posts/terraform-alem-do-basico-count-foreach-condicionais/"}</script>
<!-- End Jekyll SEO tag -->


  <!-- Custom SEO Meta Tags for Leonam Vasquez -->
  <meta name="keywords" content="Leonam Vasquez, Leonam, DevOps Engineer, Platform Engineering, SRE, AWS, Azure, GCP, Kubernetes, Docker, Terraform, Infrastructure as Code, Cloud Computing">
  <meta name="author" content="Leonam Ricardo Vasquez Ramos">
  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow">
  
  <!-- Additional Open Graph for better social sharing -->
  <meta property="og:locale" content="pt_BR">
  <meta property="article:author" content="Leonam Vasquez">
  
  <!-- Schema.org structured data -->
  <!-- Schema.org structured data for Person and Website -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "Person",
      "@id": "https://leonam.cloud/#person",
      "name": "Leonam Ricardo Vasquez Ramos",
      "alternateName": "Leonam Vasquez",
      "description": "DevOps Engineer especialista em Platform Engineering, SRE, Cloud Computing e Kubernetes",
      "jobTitle": "DevOps/Platform Engineer",
      "knowsAbout": ["DevOps", "Platform Engineering", "SRE", "AWS", "Azure", "GCP", "Kubernetes", "Docker", "Terraform", "Infrastructure as Code"],
      "url": "https://leonam.cloud",
      "sameAs": [
        "https://github.com/leonamvasquez",
        "https://linkedin.com/in/leonamvasquez"
      ],
      "email": "leonamvasquezr@gmail.com",
      "worksFor": {
        "@type": "Organization",
        "name": "DevOps/Platform Engineering"
      }
    },
    {
      "@type": "WebSite",
      "@id": "https://leonam.cloud/#website",
      "url": "https://leonam.cloud",
      "name": "Leonam Vasquez - DevOps & Platform Engineer",
      "description": "Blog técnico sobre DevOps, Platform Engineering, SRE e Cloud Computing por Leonam Vasquez",
      "publisher": {
        "@id": "https://leonam.cloud/#person"
      },
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://leonam.cloud/search?q={search_term_string}",
        "query-input": "required name=search_term_string"
      },
      "inLanguage": "pt-BR"
    },
    {
      "@type": "Blog",
      "@id": "https://leonam.cloud/#blog",
      "url": "https://leonam.cloud",
      "name": "Blog Leonam Vasquez",
      "description": "Artigos técnicos sobre DevOps, Platform Engineering, SRE, Cloud Computing e tecnologias relacionadas",
      "author": {
        "@id": "https://leonam.cloud/#person"
      },
      "publisher": {
        "@id": "https://leonam.cloud/#person"
      },
      "inLanguage": "pt-BR"
    }
  ]
}
</script>

  <title>Terraform Além do Básico: Utilizando count, for_each e Expressões Condicionais | Leonam Vasquez
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Leonam Vasquez">
<meta name="application-name" content="Leonam Vasquez">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Small set of utility classes used by the theme (ensure they exist in production
       when full Bootstrap utilities might not be present). This keeps the mask and
       sidebar toggle working even if Bootstrap is not loaded.) -->
  <style>
    .d-none { display: none !important; }
    .d-block { display: block !important; }
    .d-flex { display: flex !important; }
    .position-fixed { position: fixed !important; }
    .w-100 { width: 100% !important; }
    .h-100 { height: 100% !important; }
    .z-1 { z-index: 1 !important; }
    .z-2 { z-index: 2 !important; }
  </style>

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/foto.jpeg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">Leonam Vasquez</a>
    <p class="site-subtitle fst-italic mb-0">DevOps Engineer</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    

      
        <a
          href="https://github.com/leonamvasquez"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
          
      

      
        <a
          href="https://www.linkedin.com/in/leonamvasquez"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    

      
        <a
          href="javascript:location.href = 'mailto:' + ['leonamvasquezr','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
          
        

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Terraform Além do Básico: Utilizando count, for_each e Expressões Condicionais</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->





<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>Terraform Além do Básico: Utilizando count, for_each e Expressões Condicionais</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1761206400"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Oct 23, 2025
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1763057728"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Nov 13, 2025
</time>

        </span>
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://github.com/leonamvasquez">Leonam Ricardo Vasquez Ramos</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1108 words"
>
  <em>6 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">Terraform Além do Básico: Utilizando count, for_each e Expressões Condicionais</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">Terraform Além do Básico: Utilizando count, for_each e Expressões Condicionais</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <h2 id="introdução"><span class="me-2">Introdução</span><a href="#introdução" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>A declaração estática de recursos é o ponto de partida no Terraform. Um bloco resource define uma VM, outro define um bucket, e assim por diante. Embora funcional para setups simples, essa abordagem rapidamente se torna impraticável em cenários complexos, levando à repetição de código e dificuldade de manutenção.</p>

<p>Existem métodos mais eficientes para aplicarmos lógica e criar configurações dinâmicas e escaláveis. A transição de configurações manuais e repetitivas para a automação inteligente é viabilizada a princípio por três mecanismos: os meta-argumentos <code class="language-plaintext highlighter-rouge">count</code> e <code class="language-plaintext highlighter-rouge">for_each</code>, e o uso de expressões condicionais.</p>

<p>Este artigo demonstra como utilizar essas ferramentas para gerenciar múltiplos recursos, implementar lógica condicional e escrever código IaC eficiente e reutilizável, seguindo as melhores práticas.</p>

<h2 id="1-o-meta-argumento-count"><span class="me-2">1. O Meta-Argumento count</span><a href="#1-o-meta-argumento-count" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>O <code class="language-plaintext highlighter-rouge">count</code> permite criar múltiplas instâncias de um recurso a partir de um único bloco de código. Ele aceita um valor numérico e gera essa quantidade de cópias idênticas do recurso.</p>

<h3 id="funcionamento-básico"><span class="me-2">Funcionamento Básico</span><a href="#funcionamento-básico" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Considere a necessidade de provisionar três sub-redes em uma VPC. Em vez de duplicar o bloco <code class="language-plaintext highlighter-rouge">aws_subnet</code> três vezes, podemos empregar <code class="language-plaintext highlighter-rouge">count</code>:</p>

<div class="language-terraform highlighter-rouge"><div class="code-header">
        <span data-label-text="Terraform"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="k">variable</span> <span class="s2">"subnet_count"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"Número de sub-redes a criar"</span>
  <span class="nx">type</span>        <span class="o">=</span> <span class="nx">number</span>
  <span class="nx">default</span>     <span class="o">=</span> <span class="mi">3</span>
<span class="p">}</span>

<span class="k">resource</span> <span class="s2">"aws_subnet"</span> <span class="s2">"example"</span> <span class="p">{</span>
  <span class="nx">count</span> <span class="o">=</span> <span class="kd">var</span><span class="p">.</span><span class="nx">subnet_count</span>

  <span class="nx">vpc_id</span>            <span class="o">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">cidr_block</span>        <span class="o">=</span> <span class="s2">"10.0.</span><span class="p">${</span><span class="nx">count</span><span class="p">.</span><span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span><span class="s2">.0/24"</span>
  <span class="nx">availability_zone</span> <span class="o">=</span> <span class="s2">"us-east-1</span><span class="p">${</span><span class="nx">element</span><span class="p">([</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">],</span> <span class="nx">count</span><span class="p">.</span><span class="nx">index</span><span class="p">)}</span><span class="s2">"</span>

  <span class="nx">tags</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="o">=</span> <span class="s2">"subnet-</span><span class="p">${</span><span class="nx">count</span><span class="p">.</span><span class="nx">index</span><span class="p">}</span><span class="s2">"</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Neste exemplo, o Terraform provisionará três instâncias de <code class="language-plaintext highlighter-rouge">aws_subnet</code>. O objeto <code class="language-plaintext highlighter-rouge">count.index</code> fornece o índice da iteração atual (0, 1 e 2), possibilitando a diferenciação dinâmica de atributos como <code class="language-plaintext highlighter-rouge">cidr_block</code> e <code class="language-plaintext highlighter-rouge">availability_zone</code>.</p>

<h3 id="limitações-do-count"><span class="me-2">Limitações do count</span><a href="#limitações-do-count" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>O <code class="language-plaintext highlighter-rouge">count</code> organiza os recursos em uma lista ordenada. Se um recurso intermediário nesta lista for removido ou a ordem alterada (por exemplo, ao reduzir o count ou modificar elementos que influenciam o índice), o Terraform pode reindexar e, consequentemente, destruir e recriar recursos existentes, alterando seus IDs. Este comportamento de “deslocamento” (shifting) pode ser destrutivo e é, geralmente, indesejável em ambientes de produção.</p>

<p><strong>Uso Recomendado:</strong> O <code class="language-plaintext highlighter-rouge">count</code> é adequado para criar um número arbitrário de recursos idênticos onde a identidade individual de cada instância não é crítica, ou em conjunto com expressões condicionais para criar/não criar um recurso (discutido adiante).</p>

<h2 id="2-o-meta-argumento-for_each"><span class="me-2">2. O Meta-Argumento for_each</span><a href="#2-o-meta-argumento-for_each" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>O <code class="language-plaintext highlighter-rouge">for_each</code> foi introduzido para mitigar as limitações do <code class="language-plaintext highlighter-rouge">count</code>. Em vez de um valor numérico, ele aceita um mapa (map) ou um conjunto de strings (set of strings).</p>

<h3 id="funcionamento-e-vantagens"><span class="me-2">Funcionamento e Vantagens</span><a href="#funcionamento-e-vantagens" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>O <code class="language-plaintext highlighter-rouge">for_each</code> itera sobre os itens do mapa ou conjunto fornecido, criando uma instância de recurso para cada um. A principal diferença é que ele utiliza a chave do mapa (ou o valor do conjunto) como um identificador único e estável para cada recurso, em vez de um índice numérico.</p>

<p>Vamos voltar ao exemplo anterior das sub-redes, agora com <code class="language-plaintext highlighter-rouge">for_each</code> para gerenciar sub-redes com identidades lógicas específicas:</p>

<div class="language-terraform highlighter-rouge"><div class="code-header">
        <span data-label-text="Terraform"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="rouge-code"><pre><span class="k">variable</span> <span class="s2">"subnets"</span> <span class="p">{</span>
  <span class="nx">description</span> <span class="o">=</span> <span class="s2">"Um mapa de configurações de sub-redes a serem criadas"</span>
  <span class="nx">type</span> <span class="o">=</span> <span class="nx">map</span><span class="p">(</span><span class="nx">object</span><span class="p">({</span>
    <span class="nx">cidr_block</span> <span class="o">=</span> <span class="nx">string</span>
    <span class="nx">az</span>         <span class="o">=</span> <span class="nx">string</span>
  <span class="p">}))</span>
  <span class="nx">default</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"public_a_zone1"</span> <span class="p">=</span> <span class="p">{</span>
      <span class="nx">cidr_block</span> <span class="o">=</span> <span class="s2">"10.0.1.0/24"</span>
      <span class="nx">az</span>         <span class="o">=</span> <span class="s2">"us-east-1a"</span>
    <span class="p">},</span>
    <span class="s2">"public_b_zone2"</span> <span class="p">=</span> <span class="p">{</span>
      <span class="nx">cidr_block</span> <span class="o">=</span> <span class="s2">"10.0.2.0/24"</span>
      <span class="nx">az</span>         <span class="o">=</span> <span class="s2">"us-east-1b"</span>
    <span class="p">},</span>
    <span class="s2">"private_a_zone1"</span> <span class="p">=</span> <span class="p">{</span>
      <span class="nx">cidr_block</span> <span class="o">=</span> <span class="s2">"10.0.10.0/24"</span>
      <span class="nx">az</span>         <span class="o">=</span> <span class="s2">"us-east-1a"</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">resource</span> <span class="s2">"aws_subnet"</span> <span class="s2">"example"</span> <span class="p">{</span>
  <span class="nx">for_each</span> <span class="o">=</span> <span class="kd">var</span><span class="p">.</span><span class="nx">subnets</span>

  <span class="nx">vpc_id</span>            <span class="o">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">cidr_block</span>        <span class="o">=</span> <span class="nx">each</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">cidr_block</span>
  <span class="nx">availability_zone</span> <span class="o">=</span> <span class="nx">each</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">az</span>

  <span class="nx">tags</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="o">=</span> <span class="s2">"subnet-</span><span class="p">${</span><span class="nx">each</span><span class="p">.</span><span class="nx">key</span><span class="p">}</span><span class="s2">"</span>
  <span class="p">}</span>
<span class="p">}</span>

</pre></td></tr></tbody></table></code></div></div>

<p>Com <code class="language-plaintext highlighter-rouge">for_each</code>, os recursos são endereçados como elementos de um mapa, por exemplo: <code class="language-plaintext highlighter-rouge">aws_subnet.example["public_a_zone1"]</code>. Se a sub-rede “public_b_zone2” for removida do mapa de variáveis, o Terraform destruirá apenas essa instância específica, sem afetar as demais, devido à identidade estável fornecida pela chave (<code class="language-plaintext highlighter-rouge">each.key</code>).</p>

<p><strong>Uso Recomendado:</strong> <code class="language-plaintext highlighter-rouge">for_each</code> é a escolha ideal para iteração sobre recursos onde a identidade individual e estável de cada instância é fundamental. Ele promove um código mais previsível e de fácil manutenção.</p>

<h2 id="3-expressões-condicionais"><span class="me-2">3. Expressões Condicionais</span><a href="#3-expressões-condicionais" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>As configurações do Terraform frequentemente exigem lógica para adaptar o provisionamento a diferentes ambientes (produção, homologação, desenvolvimento) ou requisitos específicos. A ferramenta para isso é o operador ternário: <code class="language-plaintext highlighter-rouge">condição ? valor_se_verdadeiro : valor_se_falso</code>.</p>

<h3 id="31-definição-dinâmica-de-atributos"><span class="me-2">3.1. Definição Dinâmica de Atributos</span><a href="#31-definição-dinâmica-de-atributos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Este é o caso de uso mais comum, permitindo que atributos de recursos sejam definidos de forma condicional:</p>

<div class="language-terraform highlighter-rouge"><div class="code-header">
        <span data-label-text="Terraform"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="k">variable</span> <span class="s2">"environment"</span> <span class="p">{</span>
  <span class="nx">type</span>    <span class="o">=</span> <span class="nx">string</span>
  <span class="nx">default</span> <span class="o">=</span> <span class="s2">"dev"</span>
<span class="p">}</span>

<span class="k">resource</span> <span class="s2">"aws_instance"</span> <span class="s2">"web"</span> <span class="p">{</span>
  <span class="nx">ami</span>           <span class="o">=</span> <span class="s2">"ami-0c55b159cbfafe1f0"</span> <span class="c1"># Exemplo de AMI, deve ser dinâmica em um cenário real</span>
  <span class="nx">instance_type</span> <span class="o">=</span> <span class="kd">var</span><span class="p">.</span><span class="nx">environment</span> <span class="o">==</span> <span class="s2">"prod"</span> <span class="o">?</span> <span class="s2">"t3.large"</span> <span class="o">:</span> <span class="s2">"t3.micro"</span>

  <span class="nx">tags</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="o">=</span> <span class="s2">"web-</span><span class="p">${</span><span class="kd">var</span><span class="p">.</span><span class="nx">environment</span><span class="p">}</span><span class="s2">"</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Aqui, o <code class="language-plaintext highlighter-rouge">instance_type</code> da VM será <code class="language-plaintext highlighter-rouge">t3.large</code> se <code class="language-plaintext highlighter-rouge">var.environment</code> for “prod”, e <code class="language-plaintext highlighter-rouge">t3.micro</code> caso contrário.</p>

<h3 id="32-criação-condicional-de-recursos"><span class="me-2">3.2. Criação Condicional de Recursos</span><a href="#32-criação-condicional-de-recursos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Para criar ou omitir um recurso baseado em uma condição, o <code class="language-plaintext highlighter-rouge">count</code> é frequentemente combinado com uma expressão condicional:</p>

<div class="language-terraform highlighter-rouge"><div class="code-header">
        <span data-label-text="Terraform"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="k">variable</span> <span class="s2">"enable_s3_logging"</span> <span class="p">{</span>
  <span class="nx">type</span>    <span class="o">=</span> <span class="nx">bool</span>
  <span class="nx">default</span> <span class="o">=</span> <span class="kc">false</span>
<span class="p">}</span>

<span class="k">resource</span> <span class="s2">"aws_s3_bucket"</span> <span class="s2">"detailed_logs"</span> <span class="p">{</span>
  <span class="c1"># O recurso será criado (count = 1) se 'enable_s3_logging' for verdadeiro,</span>
  <span class="c1"># ou não será criado (count = 0) se for falso.</span>
  <span class="nx">count</span> <span class="o">=</span> <span class="kd">var</span><span class="p">.</span><span class="nx">enable_s3_logging</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span>

  <span class="nx">bucket</span> <span class="o">=</span> <span class="s2">"logs-detalhados-prod"</span>
  <span class="nx">acl</span>    <span class="o">=</span> <span class="s2">"private"</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Se <code class="language-plaintext highlighter-rouge">var.enable_s3_logging</code> for <code class="language-plaintext highlighter-rouge">true</code>, o bucket S3 será provisionado. Se <code class="language-plaintext highlighter-rouge">false</code>, o count será 0 e nenhum bucket será criado. Ao referenciar este recurso, o índice <code class="language-plaintext highlighter-rouge">[0]</code> deve ser utilizado: <code class="language-plaintext highlighter-rouge">aws_s3_bucket.detailed_logs[0].id</code>.</p>

<p>Para <code class="language-plaintext highlighter-rouge">for_each</code>, a criação condicional de um recurso único pode ser feita passando um mapa vazio:</p>

<div class="language-terraform highlighter-rouge"><div class="code-header">
        <span data-label-text="Terraform"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="k">resource</span> <span class="s2">"aws_s3_bucket"</span> <span class="s2">"another_logs_bucket"</span> <span class="p">{</span>
  <span class="nx">for_each</span> <span class="o">=</span> <span class="kd">var</span><span class="p">.</span><span class="nx">enable_s3_logging</span> <span class="o">?</span> <span class="p">{</span> <span class="s2">"prod_specific_bucket"</span> <span class="p">=</span> <span class="kc">true</span> <span class="p">}</span> <span class="o">:</span> <span class="p">{}</span>

  <span class="nx">bucket</span> <span class="o">=</span> <span class="s2">"minha-empresa-outros-logs-prod"</span>
  <span class="nx">acl</span>    <span class="o">=</span> <span class="s2">"private"</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Ambas as abordagens são válidas, mas o padrão <code class="language-plaintext highlighter-rouge">count = var.condicao ? 1 : 0</code> é largamente adotado para a criação condicional de recursos singulares.</p>

<h2 id="conclusão"><span class="me-2">Conclusão</span><a href="#conclusão" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>O domínio de <code class="language-plaintext highlighter-rouge">count</code>, <code class="language-plaintext highlighter-rouge">for_each</code> e expressões condicionais é um passo fundamental para otimizar suas configurações Terraform. Essas ferramentas permitem uma visão mais ampla e previsível do código terraform além da simples declaração de recursos, capacitando você a construir infraestruturas dinâmicas, escaláveis e reutilizáveis.</p>

<ul>
  <li>Utilize <code class="language-plaintext highlighter-rouge">count</code> com critério, ciente de seus potenciais impactos na reindexação de recursos.</li>
  <li>Prefira <code class="language-plaintext highlighter-rouge">for_each</code> para iterações que requerem estabilidade e identificação única de cada recurso.</li>
  <li>Empregue expressões ternárias para injetar lógica condicional, adaptando atributos e a existência de recursos conforme as necessidades do ambiente.</li>
</ul>

<p>A aplicação desses conceitos resulta em um código mais limpo, reutilizável e alinhado aos princípios do Don’t Repeat Yourself (DRY), elevando a maturidade de suas práticas com Terraform.</p>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/devops/">DevOps</a>,
          <a href="/categories/iac/">IaC</a>,
          <a href="/categories/terraform/">Terraform</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/devops/"
            class="post-tag no-text-decoration"
          >DevOps</a>
        
          <a
            href="/tags/iac/"
            class="post-tag no-text-decoration"
          >IaC</a>
        
          <a
            href="/tags/terraform/"
            class="post-tag no-text-decoration"
          >Terraform</a>
        
          <a
            href="/tags/cloud/"
            class="post-tag no-text-decoration"
          >Cloud</a>
        
          <a
            href="/tags/best-practices/"
            class="post-tag no-text-decoration"
          >Best Practices</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://www.linkedin.com/feed/?shareActive=true&shareUrl=https%3A%2F%2Fleonam.cloud%2Fposts%2Fterraform-alem-do-basico-count-foreach-condicionais%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="LinkedIn" aria-label="LinkedIn">
        <i class="fa-fw fab fa-linkedin"></i>
      </a>
    

      

      <a href="https://wa.me/?text=Terraform%20Al%C3%A9m%20do%20B%C3%A1sico:%20Utilizando%20count,%20for_each%20e%20Express%C3%B5es%20Condicionais%20-%20Leonam%20Vasquez%20https%3A%2F%2Fleonam.cloud%2Fposts%2Fterraform-alem-do-basico-count-foreach-condicionais%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="WhatsApp" aria-label="WhatsApp">
        <i class="fa-fw fab fa-whatsapp"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=https%3A%2F%2Fleonam.cloud%2Fposts%2Fterraform-alem-do-basico-count-foreach-condicionais%2F&text=Terraform%20Al%C3%A9m%20do%20B%C3%A1sico:%20Utilizando%20count,%20for_each%20e%20Express%C3%B5es%20Condicionais%20-%20Leonam%20Vasquez" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/arquitetura-de-configuracao-centralizando-a-verdade-em-sistemas-distribuidos-com-consul/">Arquitetura de Configuração: Centralizando a 'Verdade' em Sistemas Distribuídos com Consul</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/desvendando-o-hashicorp-consul-o-pilar-de-conectividade-al%C3%A9m-do-terraform-e-vault/">Desvendando o HashiCorp Consul: O Pilar de Conectividade Além do Terraform e Vault</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/gerenciamento-multiplos-ambientes-terraform-terragrunt/">Gerenciamento de Múltiplos Ambientes (Dev, Stage, Prod) com Terraform e Terragrunt</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/entendendo-containers-linux-docker-kubernetes/">Entendendo Containers: Linux, Docker e Kubernetes</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/terraform-state-o-que-e-por-que-e-importante-e-como-gerencia-lo/">Terraform State: O que é, por que é importante e como gerenciá-lo?</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/devops/">DevOps</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/iac/">IaC</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/terraform/">Terraform</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/best-practices/">Best Practices</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cloud/">Cloud</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/consul/">Consul</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/refactoring/">Refactoring</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/terraform-modules/">Terraform Modules</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cloud-native/">Cloud-Native</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/configuration-management/">Configuration Management</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/gerenciamento-multiplos-ambientes-terraform-terragrunt/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1762973032"
  data-df="ll"
  
>
  Nov 12, 2025
</time>

              <h4 class="pt-0 my-2">Gerenciamento de Múltiplos Ambientes (Dev, Stage, Prod) com Terraform e Terragrunt</h4>
              <div class="text-muted">
                <p>## Introdução  Gerenciar um único ambiente de infraestrutura com Terraform é um processo direto. No entanto, em qualquer cenário profissional, a infraestrutura é dividida em múltiplos ambientes, co...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/arquitetura-de-modulos-o-padrao-de-composicao-modulos-aninhados/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1762459200"
  data-df="ll"
  
>
  Nov  6, 2025
</time>

              <h4 class="pt-0 my-2">Arquitetura de Módulos: O Padrão de Composição (Módulos Aninhados)</h4>
              <div class="text-muted">
                <p>## Introdução  A refatoração de código Terraform para módulos locais é um passo essencial para a manutenibilidade. No entanto, à medida que a infraestrutura cresce, um novo desafio de complexidade ...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/refatorando-codigo-terraform-abstrair-monolitos-para-modulos-locais/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1761897600"
  data-df="ll"
  
>
  Oct 31, 2025
</time>

              <h4 class="pt-0 my-2">Refatorando Código Terraform: Como e Porquê Abstrair monolitos para Módulos Locais</h4>
              <div class="text-muted">
                <p>## Introdução  É comum que projetos Terraform comecem de forma simples: um único diretório com arquivos `main.tf`, `variables.tf` e `outputs.tf`. Para infraestruturas pequenas, essa abordagem funci...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/terraform-state-o-que-e-por-que-e-importante-e-como-gerencia-lo/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Terraform State: O que é, por que é importante e como gerenciá-lo?</p>
    </a>
  

  
    <a
      href="/posts/refatorando-codigo-terraform-abstrair-monolitos-para-modulos-locais/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Refatorando Código Terraform: Como e Porquê Abstrair monolitos para Módulos Locais</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://github.com/leonamvasquez">Leonam Ricardo Vasquez Ramos</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.3.1"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/devops/">DevOps</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/iac/">IaC</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/terraform/">Terraform</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/best-practices/">Best Practices</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cloud/">Cloud</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/consul/">Consul</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/refactoring/">Refactoring</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/terraform-modules/">Terraform Modules</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cloud-native/">Cloud-Native</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/configuration-management/">Configuration Management</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

